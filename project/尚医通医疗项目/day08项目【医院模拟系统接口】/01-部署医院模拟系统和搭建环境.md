# 一、部署医院模拟系统

1、参考《医院接口模拟系统.docx》进行接口测试与数据上传

2、参考《尚医通API接口文档.docx》业务接口进行接口开发

![](assets/4667db4c-e1b1-4438-bf95-777276fbc2f4-20220306153323-llcnp0s.png)

# 二、搭建接口环境

## 1、集成MongoDB

### 1.1 引入依赖

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-mongodb</artifactId>
    </dependency>
</dependencies>
```

### 1.2 添加配置

```properties
spring.data.mongodb.uri=mongodb://192.168.44.165:27017/test
```

## 2、添加医院基础类

### 2.1 添加model

```java
@Data
@ApiModel(description = "Hospital")
@Document("Hospital")
public class Hospital extends BaseMongoEntity {
    private static final long serialVersionUID = 1L;
  
    @ApiModelProperty(value = "医院编号")
    @Indexed(unique = true) //唯一索引
    private String hoscode;

    @ApiModelProperty(value = "医院名称")
    @Indexed //普通索引
    private String hosname;
  
    @ApiModelProperty(value = "医院类型")
    private String hostype;
  
    @ApiModelProperty(value = "省code")
    private String provinceCode;
  
    @ApiModelProperty(value = "市code")
    private String cityCode;
  
    @ApiModelProperty(value = "区code")
    private String districtCode;
  
    @ApiModelProperty(value = "详情地址")
    private String address;
  
    @ApiModelProperty(value = "医院logo")
    private String logoData;
  
    @ApiModelProperty(value = "医院简介")
    private String intro;
  
    @ApiModelProperty(value = "坐车路线")
    private String route;
  
    @ApiModelProperty(value = "状态 0：未上线 1：已上线")
    private Integer status;
  
    //预约规则
    @ApiModelProperty(value = "预约规则")
    private BookingRule bookingRule;

    public void setBookingRule(String bookingRule) {
        this.bookingRule = JSONObject.parseObject(bookingRule, BookingRule.class);
    }
}
```

### 2.2 添加Repository

```java
@Repository
public interface HospitalRepository extends MongoRepository<Hospital,String> {
  
}
```

### 2.3 添加service

```java
public interface HospitalService {
}

@Service
public class HospitalServiceImpl implements HospitalService {
    @Autowired
    private HospitalRepository hospitalRepository;
}
```

### 2.4 添加controller

```java
@Api(tags = "医院管理API接口")
@RestController
@RequestMapping("/api/hosp")
public class ApiController {

    @Autowired
    private HospitalService hospitalService;

}
```

说明：平台对外开发的接口都写在该Controller类
